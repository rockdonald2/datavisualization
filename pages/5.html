<!DOCTYPE html>
<html lang="en"
    class="text-black text-base md:text-lg antialiased leading-relaxed tracking-normal break-normal bg-white">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport"
            content="width=device-width, initial-scale=1.0">
        <meta name="description"
            content="A repo for studying a book.">
        <meta name="keywords"
            content="visualization,javascript,python,d3,flask,restful">
        <meta name="author"
            content="Luk√°cs Zsolt">
        <meta http-equiv="X-UA-Compatible"
            content="ie=edge">
        <title>5 Az adatok eljuttat√°sa</title>
        <link rel="stylesheet"
            href="../css/style.css">
        <!-- Safari-n az emoji favicon nem m≈±k√∂dik -->
        <link rel="icon"
            href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22
                viewBox=%220
                0
                100
                100%22><text y=%22.9em%22
                    font-size=%2290%22>üìï</text></svg>">
    </head>

    <body class="overflow-x-hidden">
        <!-- navig√°ci√≥ -->
        <nav class="pushy pushy-left">
            <div class="pushy-content">
                <ul>
                    <li class="pushy-link"><a href="../index.html">1 Bevezet√©s</a></li>
                    <li class="pushy-link"><a href="2.html">2 Els≈ë l√©p√©sek az adatvizualiz√°ci√≥ban</a></li>
                    <li class="pushy-link"><a href="3.html">3 Az adatok megszerz√©se</a></li>
                    <li class="pushy-link"><a href="4.html">4 Az adatok tiszt√≠t√°sa √©s feldolgoz√°sa</a></li>
                    <li class="pushy-link"><a href="5.html">5 Az adatok eljuttat√°sa</a></li>
                </ul>
            </div>
        </nav>

        <!-- Pushy-hoz site overlay -->
        <div class="site-overlay"></div>

        <main id="container"
            class="container p-8 md:p-6 max-w-2xl md:max-w-4xl min-h-screen mx-auto xl:ml-64">
            <button id="menu"
                class="menu-btn px-4 py-2 bg-gray-900 text-white hover:bg-blue-800 transition duration-75 ease-in rounded-md">&#9776;
                Men√º</button>

            <!-- negyedik r√©sze eleje -->

            <section class="pb-8">
                <h1 class="text-3xl md:text-4xl py-8 text-gray-900 font-semibold">5 Az adatok eljuttat√°sa</h1>

                <section id="5staticvsdynamic">
                    <h2 class="text-2xl pb-4 font-semibold text-gray-800">Az adatok eljuttat√°sa</h2>
                    <p id="firstPar"
                        class="text-lg font-normal pb-3">Miut√°n megszerezt√ºk az adatunkat √©s fel is dolgoztuk, megfigyelve bel≈ële
                        az √©rdekes r√©szeket a tiszt√≠t√°s ut√°n, nincs m√°s dolguk a val√≥di vizualiz√°ci√≥ el≈ëtt, minthogy valamilyen
                        m√≥don statikusan vagy dinamikusan eljuttasuk azt a b√∂ng√©sz≈ëbe, ahol a JavaScript feldolgozhassa. A mi
                        adatunk JSON form√°tumban van t√°rolva, teh√°t egy t√∂mbnyi objektum. Alapvet≈ëen, j√≥ h√ºvelykujj-szab√°ly az,
                        hogy egyr√©szt minden lehet adatel≈ëk√©sz√≠t√©st a Python-on bel√ºl v√©gz√ºnk el, valamint a form√°tum amiben
                        szolg√°ltassuk az adatot, a lehet≈ë legk√∂zelebb van ahhoz a form√°tumhoz, amit a JavaScript haszn√°l, a mi
                        eset√ºnkben ezek teljes√ºlnek, hiszen a D3 √°ltal t√°mogatott form√°tum az √°ltalunk is el≈ë√°ll√≠tott JSON.</p>
                    <p class="text-lg font-normal pb-3">Alapvet≈ëen, teh√°t sz√ºks√©g√ºnk lesz egy web-szerverre, amely k√©pes
                        feldolgozni a
                        HTTP lek√©rdez√©seket egy b√∂ng√©sz≈ëb≈ël, mint tudjuk a HTML f√°jlokra, CSS f√°jlokra, amelyeket a weboldal
                        fel√©p√≠t√©s√©hez tud majd haszn√°lni a b√∂ng√©sz≈ë, ugyanakkor ennek a szervernek kell kezelnie az AJAX
                        lek√©rdez√©seket is a megjelen√≠tett adatunkhoz.
                    </p>
                    <p class="text-lg font-normal pb-3">Python eset√©ben sz√°mos alternat√≠v√°nk van web-szerverre n√©zve. Ott vannak
                        az olyan egyszer≈± megold√°sok, mint a SimpleHTTPServer, illetve az olyan teljes√©rt√©k≈± rendszereket t√°mogat√≥
                        megold√°sok is, mint a Django. Azonban mi egy k√∂ztes megold√°st fogunk v√°lasztani a Flask-ot. A Flask a
                        legjobb eszk√∂z, amikor az ember csak egy egyszer≈± API-t akar l√©trehozni, hogy adatot szolg√°ltasson
                        vizualiz√°ci√≥j√°hoz.
                    </p>
                    <p class="text-lg font-normal">Els≈ë l√©p√©sben, tekinthetj√ºk ak√°r el≈ëk√©sz√≠t≈ë l√©p√©snek is, felmer√ºl a k√©rd√©s,
                        hogy hogyan szervezz√ºk meg k√∂nyvt√°raink √∂sszet√©tel√©t, amit a Flask hostolni fog. Egy j√≥ f√°jl elrendez√©s
                        nagyban megk√∂nny√≠theti a munk√°t, legyen az egy√©ni vagy kollabor√°ci√≥, a kulcsgondolat minden esetben, hogy
                        legyen egy k√∂vetkezetes mappaszerkezet√ºnk, ahogyan elrendezz√ºk f√°jlainkat. A k√∂vetkez≈ë √°bra h√°rom t√≠pus√∫
                        elrendez√©st mutat be, az egyszer≈± projektekt≈ël, az √∂sszetebbekig haladva:
                    </p>
                    <figure>
                        <img class="mx-auto"
                            src="../img/fig63.png"
                            alt="√Åbra 63">
                        <figcaption class="text-center pt-3 pb-4 text-md">63. √Åbra: A mappaorganiz√°ci√≥
                        </figcaption>
                    </figure>
                    <p class="text-lg font-normal">Amennyiben az Anaconda csomagot haszn√°ljuk azzal m√°r alap√©rtelmezetten
                        rendelkez√©s√ºnkre √°ll a Flask, ha nem, akkor egy egyszer≈± pip telep√≠t√©ssel el√©rhet≈ëv√© v√°lik:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ pip install flask</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Miut√°n megszerezt√ºk a Flask m√≥dult, semmi m√°s dolgunk, minthogy n√©h√°ny sornyi
                        k√≥ddal fel√°ll√≠tsuk a szerver√ºnket:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python">from flask import Flask

app = Flask(__name__)

# a Flask route-ok lehet≈ës√©get ny√∫jtanak arra, hogy ir√°ny√≠tsuk a webes forgalmunkat, ez a root route, jelenleg a http://localhost:8000
@app.route('/')
def hello():
    return 'Hello World!'

# be√°ll√≠tja a port-ot, amelyen a lok√°lis szerver√ºnk futni fog,
# a debug m√≥dban pedig a Flask hasznos logokat fog ki√≠rni a k√©perny≈ëre, √©s error eset√©n egy b√∂ng√©sz≈ë-alap√∫ jelent√©st fog adni
if __name__ == "__main__":
    app.run(port=8000, debug=True)</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">K√∂vetkez≈ë l√©p√©sben bel√©pve abba a mapp√°ba, ahol az el≈ëbb l√©trehozott Python
                        k√≥dunk van lefuttatjuk:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ ipython .\nobel_viz.py
 * Serving Flask app "nobel_viz" (lazy loading)
 * Environment: production
   WARNING: This is a development server. Do not use it in a production deployment.
   Use a production WSGI server instead.
 * Debug mode: on
 * Restarting with windowsapi reloader
 * Debugger is active!
 * Debugger PIN: 343-620-977
 * Running on http://127.0.0.1:8000/ (Press CTRL+C to quit)</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal pb-3">Ezut√°n a fenti weboldalra felmenve, meg is kapjuk a k√≠v√°nt eredm√©nyt.
                        Fontos
                        kit√©rni arra, hogy alap√©rtelmezetten a Flask a nagyon kiterjedt √©s el√©gg√© intuit√≠v Jinja2 templatel√©si
                        k√∂nyvt√°rat haszn√°lja, amely seg√≠ts√©g√©vel Python v√°ltoz√≥kat vagyunk k√©pesek haszn√°lni arra, hogy
                        konfigur√°ljuk √©s meghat√°rozzuk egy HTML oldal tartalm√°t.
                    </p>
                    <p class="text-lg font-normal pb-3">A templatel√©s √°ltal dinamikus weboldalakat tudunk l√©trehozni, amelyek
                        tartalm√°t a programk√≥d szerveroldalt hat√°rozza meg. Ugyanakkor, a templatel√©s vizualiz√°ci√≥kor is hasznos
                        lehet, amikor √∂ssze√°ll√≠tunk l√©nyeg√©ben statikus HTML oldalakat, teljesen szerveroldalt, de √°ltal√°ban, √©s a
                        mi megk√∂zel√≠t√©s√ºnk √©rtelm√©ben, m√©gsem √≠gy fogunk elj√°rni, hiszen ink√°bb meg√≠rjuk mi az egyszer≈± HTML
                        gerincet, amelyre JavaScript haszn√°lat√°val fogjuk fektetni a vizualiz√°ci√≥t. Ilyen esetben, val√≥j√°ban a
                        szerver feladata nem az adat szolg√°ltat√°sa √©s a statikus oldal l√©trehoz√°sa, hanem csakis kiz√°r√≥lag az adat
                        szolg√°ltat√°s√°ra sz≈±k√ºl, a szerver lesz a k√∂ztes szerepl≈ë a rendszer√ºnkben, amely dinamikusan fogja a
                        sz√ºks√©ges adatot √°tvinni, √©s csereber√©lni a b√∂ng√©sz≈ëvel, JavaScripten √©s AJAX lek√©rdez√©seken kereszt√ºl.
                    </p>
                    <p class="text-lg font-normal pb-3">Ugyanakkor, a Flask teljes m√©rt√©kben k√©pes teljes√©rt√©k≈± weboldalakat
                        futtatni, er≈ëteljes HTML templatel√©ssel, √∫n. blueprintekkel, tervrajzokkal modul√°riss√° t√©ve nagy
                        oldalakat, √©s m√©g egy rak√°snyi hasznos pluginnal √©s kieg√©sz√≠t≈ëvel kib≈ëv√≠tve. Azok az egyoldalas oldalak,
                        amiken mi a vizualiz√°ci√≥inkat fogjuk futtatni nem ig√©nyelnek sok munk√°t, ahhoz, hogy a sz√ºks√©ges statikus
                        √°llom√°nyokat eljuttas√°k a b√∂ng√©sz≈ëbe. A f≈ë c√©l√ºnk a Flaskkal szemben, hogy a lehet≈ë legkevesebb id≈ë √©s
                        energiabefektet√©ssel, a legkevesebb programk√≥ddal hozzunk l√©tre robusztus RESTful web API-kkal rendelkez≈ë
                        hat√©kony, de egyszer≈± adatszervereket. Szerencs√©nkre, az el≈ëbb megfogalmazott c√©l, egyben a Flask egyik
                        legnagyobb er≈ëss√©ge is.
                    </p>
                    <p class="text-lg font-normal pb-3">Rengeteg olyan weboldal, amely nem ig√©nyli a dinamikus konfigur√°lt adat
                        bonyodalmait, d√∂nthet √∫gy, hogy azokat statikus form√°ban viszi √°t, amely l√©nyeg√©ben azt jelenti, hogy
                        minden HTML f√°jl, √©s d√∂nt≈ëen adat (√°ltal√°ban JSON vagy CSV form√°tumban) az adatszerver f√°jlrendszer√©ben
                        tal√°lhat√≥ meg, mint √°llom√°nyok, amelyek √≠gy b√°rmif√©le k√ºls≈ë h√≠v√°s n√©lk√ºl, p√©ldak√©ppen egy adatb√°zisba
                        t√∂rt√©n≈ë h√≠v√°s n√©lk√ºl k√∂nnyen el√©rhet≈ë.
                    </p>
                    <p class="text-lg font-normal pb-3">El≈ëny√ºk az, hogy a statikus weboldalakat k√∂nny≈± cachelni, amely azt
                        eredm√©nyezi, hogy azok k√©zbes√≠t√©se is jelent≈ësen felgyorsul. Tov√°bb√°, mindenk√©ppen biztons√°gosabbak is
                        lehetnek, hiszen a rendszeres adatb√°zish√≠v√°sok k√∂nny≈± c√©lpontokk√° v√°lhatnak esetleges rosszindulat√∫
                        t√°mad√°sok eset√©n. Az √°r amit fizetn√ºnk kell az eml√≠tett el≈ëny√∂k√©rt a rugalmass√°g hi√°nya. Az √°ltal, hogy
                        √∂nmagunkat korl√°tozzuk le n√©h√°ny, el≈ëre meghat√°rozott √©s √∂ssze√°ll√≠tott oldalra azt jelenti, hogy
                        megfosztjuk a felhaszn√°l√≥t b√°rmif√©le interakci√≥t√≥l, amely ak√°r megsz√ºks√©geltetn√© azt, hogy valamilyen
                        m√≥don t√∂bbv√°ltoz√≥s adatkombin√°ci√≥k l√©trej√∂tt√©t.
                    </p>
                    <p class="text-lg font-normal pb-3">Egy kezd≈ë adatvizualiz√°ci√≥s programoz√≥ sz√°m√°ra azonban m√©gis vonz√≥ lehet
                        els≈ë
                        r√°n√©z√©sre a statikus k√©zbes√≠t√©s, hiszen ez √°ltal nagyon k√∂nnyen l√©tre tudunk hozni √∂n√°ll√≥ projekteket,
                        an√©lk√ºl, hogy b√°rmif√©le webes API-t mell√©keln√ºnk kellene. Mind√∂ssze azt a n√©h√°ny √∂ssze√°ll√≠tott HTML, CSS,
                        √©s JSON √°llom√°nyt kell k√©zbes√≠ten√ºnk a projekt futtat√°s√°hoz. Nagyj√°b√≥l √∫gy, ahogy ez a repo is m≈±k√∂dik.
                        Minden f√°jl statikusan szolg√°ltatva van a GitHub sz√°m√°ra, ahol annak Pages szolg√°ltat√°s√°t felhaszn√°lva
                        megjelen√≠tem, n√©lk√ºl√∂zve b√°rmifajta felhaszn√°l√≥i interakci√≥t, a n√©h√°ny men√ºgomb kiv√©tel√©vel, amellyel
                        √∫jabb HTTP lek√©rdez√©seket tud int√©zni a felhaszn√°l√≥ m√°r √∂ssze√°ll√≠tott statikus f√°jlokra az adatszerveren.
                    </p>
                    <p class="text-lg font-normal">Hi√°ba mondhattam el az el≈ëbb, hogy ez az oldal, amin most a sz√∂vegem √≠rom
                        val√≥j√°ban statikus, hozzunk a k√∂vetkez≈ëkben m√©gis l√©tre m√©g egyett csak a p√©lda kedv√©√©rt. L√©trehozunk a
                        'flask_project' mapp√°n bel√ºl egy √∫j index.html oldalt, egy <em>h2</em> √©s egy <em>div</em> placeholderrel,
                        valamint egy <em>script</em> taggel, amellyel bet√∂ltj√ºk a helyi <em>script.js</em> f√°jlunkat. A JavaScript
                        k√≥dot k√ºl√∂n mapp√°ba √©s √°llom√°nyba helyezz√ºk, a CSS eset√©ben a p√©ld√°ban ez nem sz√ºks√©ges, hiszen mind√∂ssze
                        egyetlen sornyi CSS-t √≠runk. A 'data' mapp√°ban pedig a Nobel gy≈ëzteseket tartalmaz√≥ JSON √°llom√°ny
                        tal√°lhat√≥ meg:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="html">&#60;!DOCTYPE html>
&#60;html lang="en">

    &#60;head>
        &#60;meta charset="UTF-8">
        &#60;meta name="viewport"
            content="width=device-width, initial-scale=1.0">
        &#60;title>Basic Example&#60;/title>

        &#60;style>
            body { font-family: sans-serif; }
        &#60;/style>
    &#60;/head>

    &#60;body>
        &#60;h2 id="data-title">&#60;/h2>
        &#60;div id="data">
            &#60;pre>&#60;/pre>
        &#60;/div>

        &#60;script src="https://d3js.org/d3.v5.min.js">&#60;/script>
        &#60;script src="js/script.js">&#60;/script>
    &#60;/body>

&#60;/html></code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Az eml√≠tett adatunk, a JSON √°llom√°ny beolvas√°s√°hoz sz√ºks√©g√ºnk lesz egy AJAX
                        h√≠v√°sra a szerver√ºnkre. Mind a jQuery, de a D3 is rendelkezik nat√≠van f√ºggv√©nnyekkel ennek megejt√©s√©hez. A
                        D3 form√°tum szerint (JSON, CSV, TSV) rendelkezik egy met√≥dussal, a k√∂vetkez≈ë p√©lda azt mutatja be, hogy
                        hogyan tud a D3 a <em>json</em> met√≥dussal beolvasni adatot, felhaszn√°lva egy callback f√ºggv√©nyt:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="javascript">d3.json('../data/winners_cleaned.json', function (error) {
    if (error) {
        console.log(error); // ha hib√°t √©szlel √≠rja ki a console-ba
    }
}).then(function(data) {
    d3.select('h2#data-title').text('All the Nobel-winners');
    // kiv√°lasztjuk a h2 tag-et √©s megv√°ltoztatjuk annak bels≈ë tartalm√°t
    d3.select('div#data pre').html(JSON.stringify(data, null, 4));
    // a stringify egy hasznos f√ºggv√©ny, 
    // amellyel egy JS objectet alak√≠tunk outputolhatov√°
    // kiv√°lasztjuk a div tag-et √©s megv√°ltoztatjuk annak bels≈ë tartalm√°t
    // az adatunk tartalm√°ra, a null param√©terrel azt hat√°rozzuk meg, hogy nincs egy f√ºggv√©ny, amely √°talak√≠tja a tartalmat,
    // a 4-es param√©terrel pedig annak indent√°ci√≥j√°t √°ll√≠tjuk be, sz√≥k√∂z√∂kben pontos√≠tva, a k√∂nnyebb olvashat√≥s√°g miatt
});</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Ezut√°n d√∂nthet√ºnk, hogy Flask-al, vagy valamilyen egysoros HTTP szerverrel
                        akarjuk futtatni a fent √≠rt k√≥dunkat. Az egyszer≈±s√©g, √©s a Flask tudatlans√°gom miatt jelenleg el√©gs√©ges
                        lesz az egyszer≈± megold√°s, futtatva a k√∂vetkez≈ë parancssori k√≥dot az 'index.html' f√°jlt tartalmaz√≥
                        mapp√°ban:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ python -m http.server</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Ha minden j√≥l ment, akkor l√°thatjuk is az oldalra kinyomva a JSON √°llom√°nyunk
                        tartalm√°t, olvashat√≥an rendezve. Fontos megeml√≠teni azt, hogy jelen esetben a Nobel-gy≈ëzteseket tartalmaz√≥
                        adatsorunk nem t√∫l nagy, de ha megpr√≥b√°ln√°nk a k√©peket √©s √©letrajzi adatokat tartalmaz√≥ √°llom√°nyt
                        bet√∂lteni, megt√∂rt√©nhetne, hogy el√©rj√ºk a b√∂ng√©sz≈ë s√°vsz√©less√©g√©nek hat√°rait, √©s az adatbeolvas√°s
                        lelass√∫lna. Egy strat√©gia a lass√∫l√°s elker√ºl√©s√©re, ha felosztjuk adatunkat kisebb r√©szekre, k√ºl√∂n√°ll√≥
                        √°llom√°nyokba, legegyszer≈±bben dimenzi√≥kk√©nt felosztva. Egy√©rtelm≈± megold√°s lenne, ha orsz√°g szerint
                        osztan√°nk sz√©t a Nobel-gy≈ëzteseket, n√©h√°ny sornyi Pandas k√≥d meg is tudja ezt tenni:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python">import pandas as pd

df_winners = pd.read_json('../data/winners_cleaned.json')

# a name jelen esetben az orsz√°g lesz, a group pedig a gy≈ëztesek
# minden orsz√°g egy k√ºl√∂n √°llom√°ny lesz, amely tartalmazni fogja a gy≈ëzteseket
for name, group in df_winners.groupby('country'):
    group.to_json('../data/winners_by_country/{}.json'.format(name), orient='records')
# nem hozza l√©tre a mapp√°t, ha nincs m√©g l√©trehozva error-t dob</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Teh√°t, a fenti k√≥d l√©trehoz n√©h√°ny tucatnyi √∫j JSON √°llom√°nyt a
                        'winners_by_country' almapp√°n bel√ºl. K√©pesek vagyunk teh√°t mostm√°r orsz√°gra lebontva leh√≠vni az annak
                        megfelel≈ë √°llom√°nyt, megk√≠m√©lve magunkat att√≥l, hogy a teljes neh√©z √°llom√°nyt minden alkalommal bet√∂lts√ºk:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python">let loadWinnersCountryJson = function(country) {
    d3.json('../data/winners_by_country/' + country + '.json', function(error) {
        if (error) {
            console.log(error);
        }
    }).then(function (data) {
        d3.select('h2#data-title').text('All the Nobel-winners from ' + country);
        d3.select('div#data pre').html(JSON.stringify(data, null, 4));
    })
}

// egyszer≈±en a f√ºggv√©nnyel leh√≠vhatjuk az √©rdekelt orsz√°g Nobel-adatait
loadWinnersCountryJson('Saint Lucia');</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal pb-3">A megfelel≈ëen rugalmas vizualiz√°ci√≥hoz elengedhetetlen a szort√≠roz√°s,
                        ahogy azt
                        a fenti p√©lda bemutatja, hogy elker√ºlj√ºk a felesleges lek√©rdez√©seket, egy√∫ttal elker√ºlve azt is, hogy
                        t√∫ls√°gosan leterhelj√ºk az adatszervert megn√∂velve a v√°laszid≈ët. Azonban, belegondolva, egyben
                        vesz√©lyforr√°s is a statikus felbont√°s, hiszen minden dimenzi√≥ szerint egy k√ºl√∂n √°llom√°nyt kellene
                        l√©trehozni, amely hossz√∫ t√°von fenntarthatatlan. Ezen a ponton m√°r elkell gondolkoznunk egy webszerver
                        fel√°ll√≠t√°s√°n, amely k√©pes lek√©rdez√©seinket dinamikusan kezelni √©s a sz√°munra sz√ºks√©ges adatot
                        kiv√°lasztani, √°ltal√°ban felhaszn√°l√≥i interakci√≥n kereszt√ºl. A k√∂vetkez≈ëkben ezt fogjok megtanulni a
                        Flask-on kereszt√ºl.
                    </p>
                    <p class="text-lg font-normal">A statikus √°tvitelnek √©s k√©zbes√≠t√©snek megvan a maga l√©tjogosults√°ga, a
                        kor√°bban eml√≠tett okokb√≥l kifoly√≥lag, √©s megkell hagyni t√∂k√©letes megold√°s k√ºl√∂nb√∂z≈ë dem√≥k √©s
                        pr√≥b√°lkoz√°sok eset√©n. Azonban a rugalmass√°g hatalmas h√°tul√ºt≈ëje, hiszen minden f√°jllal rendelkezn√ºnk kell
                        haszn√°lata el≈ëtt, nem tudjuk azt dinamikusan, a programk√≥d fut√°sa sor√°n el√©rni. Legfontosabb, hogy
                        k√ºl√∂nb√∂z≈ë felhaszn√°l√≥i hiteles√≠t√©sek, p√©ldak√©ppen egy egyszer≈± bejelentkez√©s, vagy b√°rmif√©le session
                        menedzsel√©s, hogy korl√°tozzuk a felhaszn√°l√≥k hozz√°f√©r√©s√©t mondhatni sokkal bonyol√∫ltabb lenne statikus
                        √°llom√°nyokkal. Ha blokkolni akarod bizonyos felhaszn√°l√≥k bizonyos f√°jlokhoz val√≥ hozz√°f√©r√©s√©t, sokkal
                        egyszer≈±bb √©s kultur√°ltabb megold√°s, ha azt egy API h√≠v√°son kereszt√ºl teszed. √ñsszefoglalva, oka van
                        annak, hogy az adatb√°zisok fel lettek tal√°lva, tov√°bb√° oka van annak is, hogy mi√©rt ny√∫ln√°l sz√≠vesebben
                        API-khoz amikor komplex vagy nagym√©ret≈± adatokat √©s azokhoz val√≥ hozz√°f√©r√©st kezelsz.
                    </p>
                    <p class="text-lg font-normal">Ha dinamikus tov√°bb√≠tunk valamilyen adatot, abban az esetben sz√ºks√©g√ºnk lesz
                        valamilyen API-ra, hogy lehet≈ëv√© tegye, hogy JavaScript-b≈ël lek√©rj√ºk az adatokat. A Flask eset√©ben
                        megfigyelhetj√ºk, hogy mennyire is egyszer≈± fel√°ll√≠tani egy RESTful API-t, amely kezelheti az ilyen
                        h√≠v√°sokat:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python">from flask import Flask, request, abort
from pymongo import MongoClient
from bson.json_util import dumps, default

app = Flask(__name__)

db = MongoClient().nobel_prize

@app.route('/api/winners')

def get_country_data():
    query_dict = {}

    for key in ['country', 'category', 'year']:
        # a lenti met√≥dus elr√©het≈ëv√© teszi sz√°munkra a lek√©rdez√©s argumentumjait
        # amely valahogy √≠gy n√©z ki: '?country=Australia&category=Chemistry'
        arg = request.args.get(key)

        # majd a lek√©rdez√©s argumentumjai szerint √∂ssze√°ll√≠tjuk az API h√≠v√°s lek√©rdez√©s√©t
        if arg:
            query_dict[key] = arg

    # leh√≠vjuk az adatb√°zisb√≥l a lek√©rdez√©s elemeit
    winners = db.winners_cleaned.find(query_dict)

    # ha siker√ºlt
    if winners:
        # a dumps met√≥dus nem √∫gy, mint a json.dumps met√≥dus, k√©pes szerializ√°lni m√©g d√°tum objektumokat is JSON-n√°.
        # a szerializ√°l√°s m√©gegyszer az a folyamat, amely sor√°n a komplex adatszerkezeteket byte streamm√© alak√≠tjuk
        return dumps(winners)

    # ha nem siker√ºlt le√°ll√≠tjuk 404-es st√°tuszk√≥ddal
    abort(404)

if __name__ == '__main__':
    app.run(port=8000, debug=True)</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Teh√°t, a fenti app-unk lek√©r n√©h√°ny gy≈ëztest az adatb√°zis dokumentumj√°b√≥l vagy
                        t√°bl√°j√°b√≥l, a megadott argumentumok alapj√°n. N√©zz√ºk is meg az API-nkat m≈±k√∂d√©s k√∂zben, el≈ësz√∂r a kor√°bban
                        is haszn√°lt m√≥don elind√≠tjuk az API-nkat:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ ipython .\nobel_viz.py
 * Serving Flask app "nobel_viz" (lazy loading)
 * Environment: production
   WARNING: This is a development server. Do not use it in a production deployment.
   Use a production WSGI server instead.
 * Debug mode: on
 * Restarting with windowsapi reloader
 * Debugger is active!
 * Debugger PIN: 343-620-977
 * Running on http://127.0.0.1:8000/ (Press CTRL+C to quit)</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Majd haszn√°lva a Python interpreterj√©t megkezdj√ºk a lek√©rdez√©seket:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python">import requests

response = response.get('http://127.0.0.1:8000/api/winners', params={'country': 'Australia'})
response.json()
# ...</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Mivel a Flask-unk Debug m√≥dban fut, ez√©rt √©rdekes r√©szleteket figyelhet√ºnk meg
                        a parancssorban a lek√©rdez√©s√ºnkr≈ël:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">[13/Jul/2020 23:22:10] "GET /api/winners?country=Australia HTTP/1.1" 200 -</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Nem √∫gy, mint a statikus adataink eset√©n az el≈ëz≈ë r√©szb≈ël, most nem vagyunk
                        egyetlen dimenzi√≥ra korl√°tozva, egyszer≈±en tehet√ºnk olyant, hogy lek√©rj√ºk az √∂sszes k√©mia Nobel-gy≈ëztest
                        N√©metorsz√°gb√≥l:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">response = requests.get('http://127.0.0.1:8000/api/winners', params={'country': 'Germany', 'category': 'Chemistry'})</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Bekapcsolva az SQL adatb√°zisunkat, k√©pesek vagyunk a fenti megk√∂zel√≠t√©st SQL
                        adatb√°zisokra is adapt√°lni:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python">from flask import Flask, request, abort
import dataset
from bson.json_util import dumps, default

app = Flask(__name__)

db = dataset.connect('mysql+pymysql://root@localhost/nobel_prize')

@app.route('/api/winners')
def get_country_data():
    print('Request args: {}'.format(str(dict(request.args))))

    query_dict = {}

    for key in ['country', 'category', 'year']:
        arg = request.args.get(key)

        if arg:
            query_dict[key] = arg

    winners = db['winners_cleaned'].find(**query_dict)

    if winners:
        return dumps(winners)

    abort(404)

if __name__ == '__main__':
    app.run(port=8000, debug=True)</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal pb-3">A lek√©rdez√©sek ugyan√∫gy m≈±k√∂dnek, mint a kor√°bbi p√©ld√°ban. Mostm√°r
                        elmondhat√≥, hogy elk√©sz√≠tett√ºk √©let√ºnk els≈ë RESTful API-j√°t, amellyel lek√©rdezhetj√ºk saj√°t adatb√°zisukban
                        t√°rolt adatsorunkat. Sz√°mos m√≥don kilehetne eg√©sz√≠teni, mondhatni, ez csak a j√©ghegy cs√∫csa. Azonban, az
                        eml√≠tett egyszer≈± lek√©rdez√©seken t√∫l a RESTful API m√©g sz√°mos funkcional√≠t√°ssal rendelkezik: pagination,
                        hiteles√≠t√©s. Szerencs√©nkre, nem kell mindent magunknak meg√≠rni, a Flask egy rendk√≠v√ºl n√©pszer≈± platform,
                        √©s szinte mindenre gondoltak m√°r el≈ëtt√ºnk, √≠gy sok pluginnal rendelkezik. A tov√°bbiakban a pluginok k√∂z√ºl
                        fogunk kett≈ëvel megismerkedni, egy SQL-el √©s egy MongoDB-alap√∫ NoSQL-el. Ezek a pluginok/k√∂nyvt√°rok
                        lehet≈ëv√© teszik azt, hogy teljes √©rt√©k≈± RESTful API-kat hozzunk l√©tre, mind√∂ssze n√©h√°ny sornyi Python-b√≥l,
                        biztos√≠tva mindazon adat kiv√°laszt√°sokat, amikre csak az utunk sor√°n sz√ºks√©g√ºnk lehet.
                    </p>
                    <p class="text-lg font-normal">De, azonban felmer√ºlhet a k√©rd√©s, hogy mikor sz√ºks√©ges egyik vagy m√°sik
                        megold√°st v√°lasztanunk, a statikus vs. dinamikus t√∂rt√©netben. Nem l≈ëhet√ºnk nagy mell√©, ha azt az
                        alapszab√°lyt fektess√ºk le, hogy a helyzet v√°logatja. Amennyiben a megjelen√≠tend≈ë adatunk nagy, vagy
                        jelent≈ës interakci√≥t tenne lehet≈ëv√© mindenk√©pp dinamikust v√°lasszunk. De, ha egy kis v√°rakoz√°s, bet√∂lt√©s,
                        az elej√©n megengedhet≈ë, am√≠g az adat becachel, hogy ut√°na vill√°mgyors vizualiz√°ci√≥t tegyen lehet≈ëv√©, akkor
                        j√≥ a statikus is. H√ºvelykujj-szab√°ly, hogy ha az adatsorunk nem haladja meg a 200 KB-ot, rendben lesz√ºnk a
                        statikus k√©zbes√≠t√©ssel, azonban miut√°n √°tl√©p√ºnk a MB-nyi adatokba, tal√°n jobb lenne, ha adatb√°zis-alap√∫
                        API-kra t√©rn√©nk √°t.
                    </p>
                </section>

                <section id="5datawithflask">
                    <h2 class="text-2xl pt-8 pb-4 font-semibold text-gray-800">Folytassuk a RESTful API-t</h2>
                    <p class="text-lg font-normal pb-3">Kor√°bban megismerkedt√ºnk azzal, hogy hogyan tudunk egy egyszer≈±
                        webszervert l√©trehozni Flask-al, egy olyan RESTful API-val, amely kiz√°r√≥lag GET lek√©rdez√©sekre van
                        korl√°tozva. A legt√∂bb egyszer≈± munk√°hoz √©s vizualiz√°ci√≥hoz ez a fajta megk√∂zel√≠t√©s b≈ëven elegend≈ë, legt√∂bb
                        esetben el√©gs√©ges az, ha az adatainkat az API-n kereszt√ºl el√©rhetj√ºk, de nem tudjuk onnan v√°ltoztatni is.
                        De, m√©g √≠gy is elmondhat√≥, hogy az API-nk hi√°nyos volt t√∂bb szempontb√≥l is, hiszen nem lehet vele √∫m.
                        darabokra szedni az adatainkat, nem tudjuk egyszer≈±en azt befoly√°solni √©s meghat√°rozni, hogy mekkora
                        darabokban adja vissza a lek√©rdez√©s az adatokat. Visszaadja az √∂sszeset, amely a beadott param√©terek
                        √©rtelm√©ben azoknak megfelel. Ebben a fejezetben k√©t Flask plugin-t fogunk megvizsg√°lni, amely biztos√≠tja
                        sz√°munkra ezeket a funkci√≥kat, mind√∂ssze n√©h√°ny sornyi k√≥db√≥l.</p>
                    <p class="text-lg font-normal pb-3">Kor√°bban m√°r eml√≠tettem, hogy k√©t f≈ë felhaszn√°l√°si esetr≈ël fogunk
                        besz√©lni: adatszolg√°ltat√°sr√≥l SQL-r≈ël √©s NoSQL-r≈ël, a Flask-Restless √©s Flask Eve pluginokr√≥l. Hab√°r,
                        l√©teznek olyan Flask pluginok, amelyeket tudn√°nk √∫gy alak√≠tani, hogy mindk√©t k√∂rnyezetet egyszerre
                        kiszolg√°lj√°k, azok haszn√°lata m√©gis neh√©zkes, √≠gy ink√°bb a k√∂nnyebben haszn√°lhat√≥, szakosodott pluginokra
                        fogunk kit√©rni. Els≈ëk√©nt teh√°t vegy√ºk a Flask Eve-t.</p>
                    <p class="text-lg font-normal pb-3">A Flask Eve, mint ahogy m√°r t√∂bbsz√∂r is eml√≠tett√ºk egy plugin, amely
                        egyszer≈±v√© teszi, hogy l√©trehozzunk √©s implement√°ljunk MongoDB-alap√∫ RESTful API-kat. Ha a MongoDB az
                        √°ltalad v√°lasztott adatb√°zis megold√°s, a Flask Eve az egyik legjobb megold√°s, amit v√°laszthatsz, hiszen
                        t√°mogat olyan szolg√°ltat√°sokat, mint a pagination, a hiteles√≠t√©s, √©s m√©g sz√°mos olyan dolgot, amely lefed
                        l√©nyeg√©ben minden elk√©pzelhet≈ët, amire sz√ºks√©ged lehet.</p>
                    <p class="text-lg font-normal">Mivel a Flask Eve nem k√©pezi az alap Anaconda csomag r√©sz√©t, egy egyszer≈±
                        parancssori k√≥ddal feltelep√≠thetj√ºk:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ pip install eve</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Miut√°n telep√≠tett√ºk, k√©pesek vagyunk a l√©tez≈ë MongoDB 'nobel_prize'
                        adatb√°zisunkat egy teljes √©rt√©k≈± RESTful API-val felv√©rtezni, mind√∂ssze az √°ltal, hogy l√©trehozunk egy
                        <em>settings.py</em> √°llom√°nyt. Ehhez aj√°nlott, hogy l√©trehozzunk egy √∫j mapp√°t a 'flask_project'-en
                        bel√ºl, hogy megmaradjon a rendezetts√©g√ºnk. A settings.py-ban meghat√°rozzuk az √°ltalunk prefer√°lt URL
                        prefixet az API-hoz (api), az adatb√°zis nev√©t, amit el√©rhet≈ëv√© tesz√ºnk (nobel_prize), √©s v√©g√ºl a
                        t√°bl√°zatot (winners_cleaned), ezt az utols√≥t egy <em>DOMAIN</em> azonos√≠t√≥val rendelkez≈ë dict-be:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python"># api/settings.py

# opcion√°lis MONGO v√°ltoz√≥k az adatb√°zis el√©r√©s√©hez √©s hiteles√≠t√©shez
MONGO_HOST = 'localhost'
MONGO_PORT = 27017
# MONGO_USERNAME = 'user'
# MONGO_PASSWORD = 'user'

URL_PREFIX  = 'api'
MONGO_DBNAME = 'nobel_prize'
DOMAIN = {'winners_cleaned': {
    'schema': {
        'country': {'type': 'string'},
        'category': {'type': 'string'},
        'name': {'type': 'string'},
        'year': {'type': 'integer'},
        'gender': {'type': 'string'},
        'award_age': {'type': 'integer'}
    }
}}
# a schema lehet≈ëv√© teszi, hogy 'felfedj√ºk' azokat a mez≈ëket a winners_cleaned dokumentumunkb√≥l, amelyeket el√©rhet≈ëv√© akarunk tenni
# valamint, azt is lehet≈ëv√© teszi, hogy 'data validation'-t v√©gezz√ºnk</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">A haszn√°ltakon k√≠v√ºl m√©g rengeteg param√©tert vagyunk k√©pesek be√≠rni a
                        settings.py-ba, ezek mind megtal√°lhat√≥k magyar√°zatokkal egy√ºtt a dokument√°ci√≥ban, ahol egy kiterjedt r√©sz
                        a DOMAIN konfigur√°ci√≥nak van lefoglalva. Miut√°n meghat√°roztuk a be√°ll√≠t√°sainkat, nincs m√°s dolgunk, mint
                        egy kism√©ret≈± szerver m√≥dult l√©trehozni ugyanabban a k√∂nyvt√°rban:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python"># api/server_eve.py

from eve import Eve

app = Eve()

if __name__ == '__main__':
    app.run(debug=True)</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Azt√°n k√©pesek vagyunk szerver√ºnket futtatni az api k√∂nyvt√°rba bel√©pve a
                        k√∂vetkez≈ëk√©ppen:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ ipython server_eve.py</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Mostm√°r lek√©rhetj√ºk az √∂sszes n√©met Nobel-gy≈ëztest, haszn√°lva a where kik√∂t√©st,
                        hogy meghat√°rozzuk a lek√©rdez√©s√ºnket, mindezt egy Python interpreterrel. Fontos megjegyezni, hogy ebben az
                        esetben a lek√©rdez√©s√ºnk kik√∂t√©seit m√©gegyszer a where-el hat√°rozzuk meg, √©s nem a params-el, a params
                        eset√©n az eredm√©ny nem lesz korl√°tozva, mindig az √∂sszesb≈ël fog lek√©rdezni √©s v√°ratlan eredm√©nyekhez
                        vezethet. Valamint, az Eve eset√©n alap√©rtelmezetten bevan √°ll√≠tva a pagination, ami azt jelenti, hogy nem
                        egyidej≈±leg az √∂sszeset, hanem mind√∂ssze 25 gy≈ëztest fog visszat√©r√≠teni, √©s a t√∂bbit oldalank√©nt lehet
                        el√©rni:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python">resp = requests.get('http://127.0.0.1:5000/api/winners_cleaned/?where={"country": "Germany"}')</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Valamint a Flask Eve teljes m√©rt√©kben t√°mogatja a MongoDB query document-et √©s
                        minden oper√°torj√°t, lehet≈ëv√© t√©ve azt, hogy nagyon lebontva meghat√°rozzuk azt, hogy mit is szeretn√©nk
                        megkapni, p√©ldak√©ppen k√©rj√ºk le az √∂sszes olyan gy≈ëztest, aki id≈ësebb volt, mint 75 √©v, amikor megkapta a
                        d√≠jat:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python">resp = requests.get('http://127.0.0.1:5000/api/winners_cleaned/?where={"award_age": {"$gt": 75}}')</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Teh√°t, eddig haszn√°ltuk a szok√°sos m√≥dot arra, hogy leellen≈ër√≠zz√ºk azt, hogy az
                        Eve API-nk azt csin√°lja, amit mi szeretn√©nk, hogy csin√°ljon. A k√∂vetkez≈ëkben n√©zz√ºk meg azt is, hogyan
                        tudjuk ezt az eg√©szet hasznos√≠tani AJAX lek√©rdez√©seken kereszt√ºl a b√∂ng√©sz≈ëben, vagyis a Javascriptben.
                        Ahhoz, hogy teljesen elfogulatlan legyen a teszt√ºnk, √©s, hogy egy√∫ttal azt is demonstr√°ljuk, hogy mi a
                        helyes elj√°r√°s tesztek eset√©n, az a szerver, ahonnan a lek√©rdez√©seket fogjuk c√≠mezni nem fog megegyezni
                        azzal a szerverrel, ahol az API fut. Teh√°t, l√©trehozunk egy √∫j Flask webszervert, jelen esetben a
                        'nobel_viz' mapp√°ban fog futni ez. Hozzuk l√©tre els≈ë l√©p√©sben az √∫j webszerver config √°llom√°ny√°t:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python"># nobel_viz.py

from flask import Flask, send_from_directory

app = Flask(__name__)

@app.route('/')

def root():
    return send_from_directory('.', 'index.html')
# a met√≥dus az els≈ë argumentumban meghat√°rozott mapp√°b√≥l, a m√°sodik argumentumban
# meghat√°rozott √°llom√°nyt szolg√°ltatja el√©r√©sre

if __name__ == '__main__':
    app.run(port=8000)</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Valamint, hozzuk l√©tre az index.html √°llom√°nyt is, amely tartalmazni fog n√©h√°ny
                        placeholdert a lek√©rdez√©s √©s v√°lasz adatainak, valamit hozz√°adja az √°llom√°nyhoz a jQuery √©s D3
                        k√∂nyvt√°rakat is, egy√ºtt a script.js √°llom√°nnyal, amely tartalmazni fogja az AJAX h√≠v√°sunkat:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="html">&#60;html lang="en">

    &#60;head>
        &#60;meta charset="UTF-8">
        &#60;meta name="viewport"
            content="width=device-width, initial-scale=1.0">
        &#60;title>Nobel Viz&#60;/title>

        &#60;style>
            body { font-family: sans-serif; }
        &#60;/style>
    &#60;/head>

    &#60;body>
        &#60;h3>Request&#60;/h3>
        &#60;div id="query">
            &#60;pre>&#60;/pre>
        &#60;/div>

        &#60;h3>Response&#60;/h3>
        &#60;div id="data">
            &#60;pre>&#60;/pre>
        &#60;/div>

        &#60;script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">&#60;/script>
        &#60;script src="https://d3js.org/d3.v5.min.js">&#60;/script>
        &#60;script src="static/js/script.js">&#60;/script>
    &#60;/body>

&#60;/html></code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Ahhoz, hogy megejts√ºk az AJAX GET lek√©rdez√©st, haszn√°lni fogjuk a D3 k√∂nyvt√°r
                        egyik request met√≥dus√°t, hogy l√©trehozzunk egy XMLHttpRequest-et, vagy XHR-t. A kor√°bban haszn√°lt json
                        met√≥dus kifejezetten XHR l√©trehoz√°s√°ra szakosodott, de azokon kereszt√ºl JSON √°llom√°nyokat √©rhet el. Ha a
                        lek√©rdez√©s sikeres, abban az esetben k√©szen haszn√°lhat√≥ JSON √°llom√°nyokat kapunk, egy promise form√°j√°ban.
                        A k√∂vetkez≈ë k√≥dr√©szlet egy AJAX p√©ld√°t mutat be, amelyen kereszt√ºl adatot fogunk el√©rni az Eve API-nkon
                        kereszt√ºl az adatb√°zisunkb√≥l:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="javascript">// static/js/script.js

let API_URL = 'http://127.0.0.1:5000/api';

let displayJSON = function(query) {
    d3.json(API_URL + query, function(error) {
        if (error) {
            console.log(error);
        }
    }).then(function(data) {
        d3.select('#query pre').html(query);
        d3.select('#data pre').html(JSON.stringify(data, null, 4));

        console.log(data);
    });
};

let query = '/winners_cleaned?where=' + JSON.stringify({
    "year": {"$gt": 2000},
    "gender": "female"
});

displayJSON(query);</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Miut√°n minden a hely√©n van, el is ind√≠thatjuk az √∫j szerver√ºnket, amellyel
                        √©l≈ëben is tesztelhetj√ºk a l√©trehozott API-nkat:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ ipython nobel_viz.py</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal pb-3">Azt√°n megnyitva a szerver√ºnk el√©r√©s√©t, megfigyelhetj√ºk azt, hogy a leh√≠v√°s
                        nem
                        siker√ºlt. Megnyitva a b√∂ng√©sz≈ë ablak√°t √©szrevehetj√ºk, hogy az API lek√©rdez√©s√ºnk a CORS korl√°toz√°s miatt
                        kudarcot vallot. R√∂viden a CORS korl√°toz√°s, vagy a cross-origin resource sharing teljesen ki√≠rva, egy
                        biztons√°gi korl√°toz√°s, amely megakad√°lyozza azt, hogy a JavaScript olyan weboldalr√≥l vagy szerverr≈ël
                        k√©rjen le adatokat, amely nem egyenl≈ë azzal, ahol ≈ë maga fut. Alap√©rtelmezetten ezek a lek√©rdez√©sek tiltva
                        vannak, ez√©rt futhatunk a kor√°bban l√°that√≥ hib√°ba. K√©pesek vagyunk az Access-Control-Allow-Origin header
                        m√≥dos√≠t√°s√°val be√°ll√≠tani azt, hogy mely oldalokr√≥l szabad adatot lek√©rnie a JavaScriptnek, elker√ºlve a
                        hib√°t. K√©pesek vagyunk ezt √°t√°ll√≠tani *-ra, azaz √∂sszesre, vagy meghat√°rozni domaineket, ahonnan szabad a
                        lek√©rdez√©s. Production appok eset√©ben jobb, ezt a k√∂ztes adatcser√©t egy HTTP szerverre b√≠zni, Apache-re,
                        vagy Nginx-re, de k√ºl√∂nb√∂z≈ë tesztek eset√©ben m√©gis a CORS-ot haszn√°ljuk az√©rt, hogy megk√∂nny√≠ts√ºk a
                        folyamatot.</p>
                    <p class="text-lg font-normal">A CORS korl√°toz√°sra vonatkoz√≥an, az Eve sz√°mos v√°ltoz√≥val rendelkezik, amely
                        lehet≈ëv√© teszi sz√°munkra, hogy felfedj√ºnk egyed√ºl√°ll√≥ API-kat bizonyos weboldalaknak. P√©ldak√©ppen, a
                        <em>X_DOMAINS</em> v√°ltoz√≥ lehet≈ëv√© teszi egy list√°nyi domain meghat√°roz√°s√°t, amelyek sz√°m√°ra √≠gy szabadd√°
                        v√°lik a CORS lek√©rdez√©s. A v√°ltoz√≥ bevehet egy stringet, vagy egy list√°nyi stringet a domainekkel, ahonnan
                        a h√≠v√°sok j√∂hetnek. Teh√°t, a mi eset√ºnkben meghat√°rozzuk azt az el√©r√©st, amelyen az index.html f√°jlunk van
                        megjelen√≠tve, √©s ahol kudarcot vallott a lek√©rdez√©s:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python">X_DOMAINS = 'http://127.0.0.1:8000'</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal pb-3">De az el≈ëbb eml√≠tett logika ment√©n, ak√°r *-ra is √°ll√≠thattuk volna,
                        lehet≈ëv√©
                        t√©ve b√°rhonnan az API el√©r√©s√©t. Miut√°n ezt a be√°ll√≠t√°st megejtett√ºk, √∫jraind√≠thatjuk mindk√©t szerver√ºnket,
                        √©s ut√°na a h√≠v√°s lekellene fusson.</p>
                    <p class="text-lg font-normal pb-3">Teh√°t, mostm√°r tudjuk azt, hogy hogyan lehet egy MongoDB RESTful API-t
                        l√©trehozni mind√∂ssze n√©h√°ny sornyi k√≥db√≥l, a tov√°bbiakban n√©zz√ºk meg azt, hogy hogyan tudjuk ezt
                        kib≈ëv√≠teni, ahhoz, hogy eljuttassuk a Nobel-d√≠jas adatsorunkat a vizualiz√°ci√≥nkhoz.</p>
                    <p class="text-lg font-normal pb-3">Ezen a ponton h√°rom adatsorral rendelkez√ºnk, amelyekre sz√ºks√©g√ºnk lesz a
                        vizualiz√°ci√≥nkhoz, a gy≈ëzteseket tartalmaz√≥ 'winners_cleaned' adatsor, az √©letrajzi adatokat √©s a k√©peket
                        tartalmaz√≥ 'winners_bios', v√©g√ºl pedig van nek√ºnk egy 'country_data' adatsorunk is, az
                        orsz√°gadatokkal.</p>
                    <p class="text-lg font-normal pb-3">A gy≈ëzteseket √©s az orsz√°gadatokat tartalmaz√≥ adatsorok m√©retben kicsik,
                        mind√∂ssze 200-300 KB-osak, valamint a vizualiz√°ci√≥ sor√°n v√©gig sz√ºks√©g√ºnk lesz r√°juk, meg√©rn√© eg√©sz√ºkben
                        let√∂lteni ≈ëket. Azonban, az √©letrajzi adatokat tartalmaz√≥ adatsor ezzel szemben m√°r MB-os kateg√≥ria,
                        valamint nincs is sz√ºks√©g√ºnk r√° minden pillanatban, egyidej≈±leg csakis egyre, teh√°t sokkal c√©lszer≈±bb
                        lenne, ha sz√ºks√©g eset√©n lenn√©nek csak let√∂ltve, felhaszn√°l√≥i interakci√≥ra.</p>
                    <p class="text-lg font-normal pb-3">A MongoDB-s √©s Eve-s megk√∂zel√≠t√©s√ºnket fogjuk haszn√°lni, hogy az adatokat
                        eljuttassuk. Azonban, tarthatn√°nk ak√°r k√ºl√∂n a 'winners_cleaned' √©s a 'winners_bios' adatsorainkat,
                        azonban egy dokumentum-alap√∫ adatb√°zisban logikailag helyt√°ll√≥bb, ha egy adott gy≈ëztesr≈ël sz√≥l√≥ minden
                        adat, egyetlen dokumentumban tal√°lhat√≥ meg. Ez egyidej≈±leg le is egyszer≈±s√≠ti az API-nkat egyetlen
                        felfedett domainre √©s t√°bl√°ra. Teh√°t, ink√°bb haszn√°lni fogjuk a 'winners_cleaned_w_bios' adatb√°zisunkat,
                        amely tartalmazza az √∂sszes Nobel-gy≈ëztes adat√°t, egy√ºtt az √©letrajzi paragrafusokkal.</p>
                    <p class="text-lg font-normal">Els≈ë l√©p√©sben adapt√°ljuk a settings.py √°llom√°nyunkat az √∫j DOMAIN-hez,
                        be√°ll√≠tva az X_DOMAINS v√°ltoz√≥t, hogy szabadon engedjen b√°rmilyen CORS lek√©rdez√©st (√≠gy b√°rmilyen
                        domainr≈ël t√∂rt√©nhet lek√©rdez√©s, azonban csak fejleszt√©s sor√°n aj√°nlott ez a megk√∂zel√≠t√©s). Ugyanakkor, a
                        HATEOAS v√°ltoz√≥t is Hamisra √°ll√≠tjuk, mivel nem fogjuk ezeket a linkeket haszn√°lni, valamint a pagination
                        feature-t is kikapcsoljuk, √≠gy lek√©rdez√©skor egyszerre megkapjuk az √∂sszes k√©rt adatot:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python"># api/settings.py

# opcion√°lis MONGO v√°ltoz√≥k az adatb√°zis el√©r√©s√©hez √©s hiteles√≠t√©shez
MONGO_HOST = 'localhost'
MONGO_PORT = 27017
# MONGO_USERNAME = 'user'
# MONGO_PASSWORD = 'user'

URL_PREFIX  = 'api'
MONGO_DBNAME = 'nobel_prize'
DOMAIN = {'winners_cleaned_w_bios': {
    'schema': {
        'country': {'type': 'string'},
        'category': {'type': 'string'},
        'name': {'type': 'string'},
        'year': {'type': 'integer'},
        'gender': {'type': 'string'},
        'award_age': {'type': 'integer'},
        'mini_bio': {'type': 'string'},
        'bio_image': {'type': 'string'}
    },
    'url': 'winners'
    # az url key lehet≈ëv√© teszi azt, hogy elt√©rj√ºnk az alap√©rtelmezett el√©r√©st≈ël, ami a fenti hossz√∫,
    # teh√°t a jelenlegi el√©r√©s /api/winners?where...
}}
# a schema lehet≈ëv√© teszi, hogy 'felfedj√ºk' azokat a mez≈ëket a winners_cleaned dokumentumunkb√≥l, amelyeket el√©rhet≈ëv√© akarunk tenni
# valamint, azt is lehet≈ëv√© teszi, hogy 'data validation'-t v√©gezz√ºnk

X_DOMAINS = '*'
HATEOAS = False
# a HATEOAS kikapcsolja azokat a linkeket, amelyekkel a response-ban tal√°lkozhatn√°nk: _links,
# ez a link arra vonatkoz√≥ inform√°ci√≥kat tartalmaz, hogy milyen a k√ºl√∂nb√∂z≈ë el√©rt er≈ëforr√°sok k√∂z√∂tti kapcsolat: self, parent, next, prev, stb.
# √≠gy √∫gy lenn√©nk k√©pesek dinamikusan friss√≠teni a UI-t, vagy navig√°lni az API-ban, hogy nem tudjuk el≈ëre annak strukt√∫r√°j√°t,
# jelen esetben tudjuk, nincs sz√ºks√©g ezekre
PAGINATION = False
# minden eredm√©nyt egy √°llom√°nyban adjon vissza, nincs sz√ºks√©g oldalakra szedni ≈ëket</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal pb-3">Ugyanazt a szerver √∂sszet√©telt fogjuk haszn√°lni, mint az el≈ëz≈ë teszt
                        p√©ld√°ban, felhaszn√°lva a <em>displayJSON</em> met√≥dusunkat, hogy elk√ºldj√∂n egy URL-t √©s n√©mi lek√©rdez√©si
                        adatot egy AJAX GET lek√©rdez√©sbe. Ha a lek√©rdez√©s pedig sikeres, abban az esetben meg is jelen√≠ti a
                        weboldalon.</p>
                    <p class="text-lg font-normal pb-3">A vizualiz√°ci√≥n bel√ºl k√©t f√©le lek√©rdez√©st fogunk megejteni az adatunkra:
                        egyr√©szt, lek√©rj√ºk az alapvet≈ë adatokat az √∂sszes Nobel-gy≈ëztesr≈ël, kihagyva azonban a mini_bio mez≈ëket,
                        m√°sodr√©szt, pedig lek√©rj√ºk majd egy egy√©ni gy≈ëztes teljes adat√°t.</p>
                    <p class="text-lg font-normal">Ahhoz, hogy megejts√ºk a fent eml√≠tett els≈ë lek√©rdez√©s√ºnket, megkell mondanunk
                        az API-nak, hogy tartsa vissza a mini_bio mez≈ët. Ezt k√©pesek lesz√ºnk el√©rni felhaszn√°lva az Eve egyik
                        funkcionalit√°s√°t, a <em>projections</em>-t. A projections lehet≈ëv√© teszi sz√°munkra azt, hogy meghat√°rozott
                        mez≈ëket "kikapcsoljunk". Sz√≥val, ahhoz, hogy megkapjunk minden gy≈ëztes adatot, kihagyva a mini_bio mez≈ët,
                        csak hozz√° kell adnunk a projection argumentumot az API lek√©rdez√©s√ºnkh√∂z:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="javascript">let query = '/winners?projection=' + JSON.stringify({
    "mini_bio": 0
});</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal pb-3">Kis kiutal√≥ az el≈ëz≈ë helyzetre. Alapvet≈ëen, probl√©m√°ba √ºtk≈ëztem amikor
                        megpr√≥b√°ltam a lek√©rdez√©st megcsin√°lni, hiszen minden esetben egy <em>unexpected token</em> hib√°ba
                        futottam a b√∂ng√©sz≈ë console-j√°ban. A probl√©ma az volt, hogy azon esetekkor, amikor nem volt a gy≈ëzteshez
                        k√©p az √ºres 'bio_image' mez≈ë NaN-t tartalmazott. Alapj√°ban v√©ve ez nem kellene probl√©m√°t okozzon, hiszen a
                        sz√°mokat tartalmaz√≥ mez≈ëkn√©l nem volt gond, itt szerintem a string kavart be. A probl√©m√°t meglehetett
                        oldani az √°ltal, hogy kijav√≠tottam az adatb√°zis adatsor√°t, az √°ltal, hogy az √ºres 'bio_image' mez≈ëket
                        NaN-r√≥l None-ra √°ll√≠tottam, ami JSON eset√©ben null-k√©nt jelenik meg, √≠gy sikeresen lelehet k√©rni a
                        Nobel-gy≈ëztesek adatait az AJAX h√≠v√°son kereszt√ºl.</p>
                    <p class="text-lg font-normal">A vizualiz√°ci√≥nk r√©szek√©nt azt akarjuk, hogy a felhaszn√°l√≥ k√©pes legyen
                        kiv√°lasztani egyet a gy≈ëztesek k√∂z√ºl egy list√°b√≥l, majd a kiv√°laszt√°s ut√°n arr√≥l a gy≈ëztesr≈ël nek√ºnk
                        megkell jelen√≠ten√ºnk, ha rendelkez√©s√ºnkre √°ll egy f√©nyk√©pet, illet≈ëleg minden esetben a r√∂vid √©letrajzi
                        kiutal√≥kat. Nam√°r most, k√©pesek lenn√©nk az egy√©neket el√©rni ak√°r n√©vszerint a where kik√∂t√©ssel, azonban
                        ekkor fog k√©pbe j√∂nni a MongoDB √°ltal l√©trehozott id mez≈ë, amely minden gy≈ëztes sz√°m√°ra √©rtelemszer≈±en
                        egyedi:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="javascript">/* let query = '/winners?where=' + JSON.stringify({
    "name": "Albert Einstein"
}); */

// m√°sik el√©r√©si m√≥d
// Einstein ID-ja a = 5f0dcfe5b7fb6ee9b727573f
// /api/winners/5f0dcfe5b7fb6ee9b727573f
const albert_id = '5f0dcfe5b7fb6ee9b727573f'
let query = '/winners/' + albert_id</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal pb-3">Teh√°t, m√°r rendelkez√ºnk azzal a RESTful API-val, amelynek haszn√°lat√°val
                        eljuthatunk a Nobel-d√≠jas adatsorunk b√°rmely r√©sz√©hez. Azonban, ez m√©g mindig csak az egyik plugin volt,
                        amir≈ël ebben a r√©szben besz√©ln√ºnk kellett, k√∂vetkezzen teh√°t a Flask-Restless, amely egy SQL-k√©pes plugin,
                        szemben az Eve NoSQL elfogults√°g√°val.</p>
                    <p class="text-lg font-normal">A Flask-Restless nem k√©pezi az Anaconda csomag r√©sz√©t, de a megszokott m√≥don
                        k√∂nnyen telep√≠thet≈ë:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ pip install flask-restless</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Azonban a Flask-Restless megfelel≈ë m≈±k√∂d√©s√©hez a Flask-SQLAlchemy pluginra is
                        sz√ºks√©g√ºnk lesz, teh√°t azt is telep√≠tj√ºk:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ pip install flask-sqlalchemy</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Miut√°n telep√≠tett√ºk a m√≥dulunkat, l√©tre is hozhatjuk az API-t felhaszn√°lva a
                        MySQL adatb√°zisunkat, ahov√° egy m√°solata a kor√°bban az Eve eset√©ben haszn√°lt adatsornak megtal√°lhat√≥. A
                        'winners_cleaned_w_bios' t√°bla tartalmazza a megtiszt√≠tott adatunkat az √©letrajzzal egy√ºtt, teh√°t ezt
                        fogjuk el√©rhet≈ëv√© tenni az API-n kereszt√ºl, felhaszn√°lva egy SQLAlchemy s√©m√°t, hogy meghat√°rozzuk a
                        sz√ºks√©ges adatokat:</p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python"># server_flask_restless.py

import flask
import flask_sqlalchemy
import flask_restless

# l√©trehozzuk a Flask applik√°ci√≥t √©s a Flask-SQLAlchemy objektumot
app = flask.Flask(__name__)
app.config['DEBUG'] = True
app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://root@localhost/nobel_prize'

db = flask_sqlalchemy.SQLAlchemy(app)

# ezut√°n l√©trehozzuk a Flask-SQLAlchemy modelleket, a megszokott m√≥don,
# de k√©t fontos resztrikci√≥val:
#   1. Musz√°j legyen ezeknek a modelleknek egy primary key oszlopja, vagy sqlalchemy.Integer vagy sqlalchemy.Unicode t√≠pusb√≥l
#   2. Musz√°j legyen egy __init__ met√≥dusuk, amely az √∂sszes oszlopra fogad el kulcssz√≥ argumentumokat
# a 2. eset√©ben elmondhat√≥, hogy a flask.ext.sqlalchemy.SQLAlchemy.Model biztos√≠t egy ilyen __init__ met√≥dust,
# teh√°t nem kell √∫jat l√©trehozzunk jelenesetben

# alap√©rtelmezetten a lenti modell neve a t√°bla neve kell legyen,
# de ezt expliciten a lenti v√°ltoz√≥val is k√©pesek vagyunk meghat√°rozni
class Winners(db.Model):
    __tablename__ = 'winners_cleaned_w_bios'

    index = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.Unicode, unique=True)
    category = db.Column(db.Unicode)
    year = db.Column(db.Unicode)
    country = db.Column(db.Unicode)
    gender = db.Column(db.Unicode)
    award_age = db.Column(db.Integer)

# l√©trehozza az adatb√°zis t√°bl√°kat
db.create_all()

# l√©trehozzunk egy Flask-Restless API managert
manager = flask_restless.APIManager(app, flask_sqlalchemy_db=db)

# l√©trehozzuk az API endpointokat, amelyek el√©rhet≈ëk lesznek az /api/&#60;t√°blan√©v>-en alap√©rtelmezetten
# meghat√°rozhatjuk a HTTP met√≥dusokat is, amelyek el√©rhet≈ëk lesznek
manager.create_api(Winners, methods=['GET'], max_results_per_page=1000)

# elind√≠tjuk a Flask loopot
app.run()</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">A k√∂vetkez≈ëkben a CORS-al is foglalkoznunk kell megint. Term√©szetesen
                        production sor√°n valamilyen szerver int√©zi el ezt nek√ºnk, azonban fejleszt√©s sor√°n m√©gis j√≥l j√∂n, ha mi
                        magunk tudjuk be√°ll√≠tani a megengedett domaineket, azonban ehhez egy √∫jabb Flask pluginra lesz sz√ºks√©g√ºnk:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ pip install flask-cors</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Miut√°n telep√≠tett√ºk csak n√©h√°ny sorral kell kieg√©sz√≠ts√ºk az el≈ëbbi
                        szerver√ºnket, hogy megkapjuk a CORS t√°mogat√°st:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="python"># server_flask_restless.py

import flask
import flask_sqlalchemy
import flask_restless
from flask_cors import CORS

# l√©trehozzuk a Flask applik√°ci√≥t √©s a Flask-SQLAlchemy objektumot
app = flask.Flask(__name__)
app.config['DEBUG'] = True
app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://root@localhost/nobel_prize'

app.config['CORS_ALLOW_HEADERS'] = "Content-Type"
app.config['CORS_RESOURCES'] = {r"/api/*": {"origins": "*"}}

db = flask_sqlalchemy.SQLAlchemy(app)


# ezut√°n l√©trehozzuk a Flask-SQLAlchemy modelleket, a megszokott m√≥don,
# de k√©t fontos resztrikci√≥val:
#   1. Musz√°j legyen ezeknek a modelleknek egy primary key oszlopja, vagy sqlalchemy.Integer vagy sqlalchemy.Unicode t√≠pusb√≥l
#   2. Musz√°j legyen egy __init__ met√≥dusuk, amely az √∂sszes oszlopra fogad el kulcssz√≥ argumentumokat
# a 2. eset√©ben elmondhat√≥, hogy a flask.ext.sqlalchemy.SQLAlchemy.Model biztos√≠t egy ilyen __init__ met√≥dust,
# teh√°t nem kell √∫jat l√©trehozzunk jelenesetben

# alap√©rtelmezetten a lenti modell neve a t√°bla neve kell legyen,
# de ezt expliciten a lenti v√°ltoz√≥val is k√©pesek vagyunk meghat√°rozni
class Winners(db.Model):
    __tablename__ = 'winners_cleaned_w_bios'

    index = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.Unicode, unique=True)
    category = db.Column(db.Unicode)
    year = db.Column(db.Unicode)
    country = db.Column(db.Unicode)
    gender = db.Column(db.Unicode)
    award_age = db.Column(db.Integer)

# l√©trehozza az adatb√°zis t√°bl√°kat
db.create_all()

# l√©trehozzunk egy Flask-Restless API managert
manager = flask_restless.APIManager(app, flask_sqlalchemy_db=db)

# l√©trehozzuk az API endpointokat, amelyek el√©rhet≈ëk lesznek az /api/<t√°blan√©v>-en alap√©rtelmezetten
# meghat√°rozhatjuk a HTTP met√≥dusokat is, amelyek el√©rhet≈ëk lesznek
# a collection_name-el meglehet hat√°rozni az endpointokat, amelyen kereszt√ºl el√©rhet≈ë lesz az API
manager.create_api(Winners, collection_name='winners', methods=['GET'], max_results_per_page=1000)

cors = CORS(app)

# elind√≠tjuk a Flask loopot
app.run()</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Miut√°n mindent fel√°ll√≠tottunk a m≈±k√∂d√©shez, nincs m√°s dolgunk mint elind√≠tani a
                        RESTful szerver√ºnket:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="shell">$ python server_flask_restless.py</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal pb-3">A szerver√ºnk mostm√°r sikeresen fut, a Flask-Restless API a lek√©rdez√©si
                        oper√°torok sz√©les k√∂r√©t t√°mogatja, lehet≈ëv√© t√©ve, hogy eg√©sz pontosan meghat√°rozd azokat az adatokat,
                        amelyeket megakarn√°l szerezni. A Flask-Restless lek√©rdez√©si motorja nagyj√°b√≥l lek√∂veti a szabv√°ny SQL
                        m≈±veleteket:
                    </p>
                    <figure>
                        <img class="mx-auto"
                            src="../img/fig64.png"
                            alt="√Åbra 64">
                        <figcaption class="text-center pt-3 pb-4 text-md">64. √Åbra: A Flask-Restless √°ltal t√°mogatott oper√°torok
                            list√°ja
                        </figcaption>
                    </figure>
                    <p class="text-lg font-normal">Teh√°t, haszn√°lhatjuk a kor√°bban l√©trehozott <em>displayJSON</em> met√≥dusunkat,
                        hogy lek√©rj√ºnk n√©mi JSON adatot az API-nkb√≥l, egy query string seg√≠ts√©g√©vel:
                    </p>
                    <pre class="my-4 text-sm md:text-md font-semibold rounded-md overflow-auto text-gray-200"><code class="javascript">let filters = [ {"name": "year", "op": "gte", "val": 2000},
                {"name": "gender", "op": "==", "val": "female"}
];

let order_by = [ {"field": "year", "direction": "asc"}];

let query = '/winners?' + 'q=' + JSON.stringify({'filters': filters, 'order_by': order_by});

displayJSON(query);</code><button id="copy"
    class="text-sm md:text-md font-semibold">M√°sold</button></pre>
                    <p class="text-lg font-normal">Ha minden j√≥l m≈±k√∂d√∂tt a weboldalon megkell jelenjenek a 2000 ut√°n gy≈ëz√∂tt n≈ëi
                        Nobel-gy≈ëztesek. √ârdekess√©gk√©nt megfigyelhetj√ºk azt, hogy sem metaadata, sem HATEOS linkek nem szerepelnek
                        a lek√©rdez√©s v√°lasz√°ban, csakis azok a mez≈ëk, amelyeket az SQLAlchemy modellben meghat√°roztunk. Ez
                        bizonyos applik√°ci√≥k sz√°m√°ra h√°tr√°ny lenne, azonban a legt√∂bb vizualiz√°ci√≥s munk√°hoz el√©gs√©ges.
                    </p>
                </section>
            </section>

            <!-- √∂t√∂dik r√©sze v√©ge -->

            <div class="my-8 flex content-center">
                <button
                    class="flex-auto w-24 bg-gray-900 text-white group hover:bg-blue-800 transition duration-75 ease-in rounded-md"><a
                        class="block px-4 py-2"
                        href="3.html"><span class="inline-block font-normal transform group-hover:-translate-x-1 transition
                            duration-100 ease-in">&larr;</span>
                        El≈ëz≈ë</a></button>
                <!-- <button class="flex-auto w-24 ml-4 py-2 bg-gray-900 text-white group hover:bg-blue-800 transition duration-75
                    ease-in rounded-md"><a class="block px-4"
                        href="5.html">K√∂vetkez≈ë
                        <span
                            class="inline-block font-normal transform group-hover:translate-x-1 transition duration-100 ease-in">&rarr;</span></a></button> -->
            </div>
        </main>

        <div id="arr"
            class="fixed block transition duration-100 ease-in"><a class="inline-block text-3xl py-3 px-6 hover:text-blue-800 transition duration-100 ease-in transform hover:scale-125
                opacity-50 hover:opacity-100"
                href="#menu">&uarr;</a></div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.10.2/underscore-min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
        <script src="../tools/pushy-1.3.0/js/pushy.min.js"></script>
        <!-- cross-platform megold√°s a smooth-scroll-ra, jQuery haszn√°lat√°val -->
        <script src="../javascript/smooth.js"></script>
        <script src="../javascript/main.js"></script>
        <script src="../javascript/introd3.js"></script>
    </body>

</html>